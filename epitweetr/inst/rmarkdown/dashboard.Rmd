---
title: "epitweetR Dashboard"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
params:
  topics: ["COVID-19"]
  countries: ["1", "2"]
  period_type: "created_date"
  period: ["2020-01-01", "2020-03-31"]
  with_retweets: FALSE
  location_type: "tweet"
  alert_alpha: 0.025
  alert_historic: 7
  bonferroni_correction: FALSE
  same_weekday_baseline: FALSE
---

```{r include=FALSE}
regions <- get_country_items()
countries <- Reduce(function(l1, l2) {unique(c(l1, l2))}, lapply(as.integer(params$countries), function(i) unlist(regions[[i]]$codes)))
region_names <- lapply(as.integer(params$countries), function(i) regions[[i]]$name)

```

# epitweetR dashboard
Parameters

* Topics: `r params$topics`
* Regions: `r region_names`
* Period type: `r params$period_type`
* Period: `r params$period`
* With retweets: `r params$with_retweets`
* Location Type: `r params$location_type`
* Signal detection confidence (alpha): `r as.character(params$alert_alpha)`
* Days in baseline: `r params$alert_historic`
* Boferroni correction: `r params$bonferroni_correction`
* Same weekday baseline: `r params$same_weekday_baseline`

## Line chart
```{r, echo = FALSE, message=FALSE, warning=FALSE}
line_chart_from_filters(
  params$topics, 
  params$countries, 
  params$period_type, 
  params$period, 
  params$with_retweets, 
  params$location_type, 
  params$alert_alpha, 
  params$alert_historic,
  params$bonferroni_correction,
  params$same_weekday_baseline
  )$chart
```

## Top words chart
```{r, echo = FALSE, message=FALSE, warning=FALSE}
topwords_chart_from_filters(
  params$topics, 
  params$countries, 
  params$period_type, 
  params$period, 
  params$with_retweets, 
  params$location_type,
  20
  )$chart
```

## Map Chart
```{r, echo = FALSE, message=FALSE, warning=FALSE}
map_chart_from_filters(
  params$topics, 
  params$countries, 
  params$period_type, 
  params$period, 
  params$with_retweets, 
  params$location_type
  )$chart
```


`r ""`
